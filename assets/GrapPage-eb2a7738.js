import{r,u as c,f as h,i as C,k as G,l as w,h as i,p as y,m as H,C as P,j as s,L as S,n as q}from"./index-aedadce1.js";/* empty css               */import{p as L}from"./productListSelectors-0c3c34c1.js";import{L as J}from"./LoadingModal-4c968ee5.js";import{D as R}from"./Dates-723548b0.js";import{R as K}from"./index-447347f3.js";import{u as Q}from"./useDispatch-1fd65c90.js";import"./v4-4a60fe23.js";const ls=()=>{var N,f,v,b,F;const[x,k]=r.useState(0),A=e=>{k(e)},d=c(h.selectTotalPerday),$=c((N=C)==null?void 0:N.selectLoading),D=c(C.selectRows);G();const t=Q(),o=c(w.selectCurrentUser),a=c(L.selectRows),p=c(L.selectLoading),[I,m]=r.useState(!1),[j,_]=r.useState(!1),u=c(h.selectCountRecord),E=c(h.selectError),M=r.useCallback(async()=>{try{await t(i.doFetch()),await t(y.doFetch()),await t(H.doRefreshCurrentUser()),await t(i.doCountDay())}catch(e){console.error("Error during refreshing items:",e)}},[t]);r.useMemo(()=>{var e;return parseInt(u)===parseInt((e=o==null?void 0:o.vip)==null?void 0:e.dailyorder)},[u,o]);const z=async()=>{try{if(_(!0),await t(i.doCheck()),E)return;await t(y.doFetch()),setTimeout(()=>{m(!0)},1e3),_(!1)}catch{_(!1)}},B=()=>{m(!1)},[g]=r.useState(R.Number());r.useEffect(()=>{t(i.doCount()),t(P.doFetch()),t(i.doCountDay())},[t]);const O=(e,n)=>(parseFloat(n)/100*parseFloat(e)).toFixed(3),l=c(w.selectCurrentUser),T=async()=>{const e={number:g,product:a==null?void 0:a.id,status:a!=null&&a.combo?"pending":"completed",user:l.id,rating:x};await t(q.doCreate(e)),await M(),m(!1)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"market__header",children:!$&&D.map(e=>{var n;return s.jsx("img",{src:(n=e==null?void 0:e.photo[0])==null?void 0:n.downloadUrl,alt:"",className:"logo__header"})})}),s.jsxs("div",{className:"app__grappage",children:[s.jsx("div",{className:"grap__movies",children:s.jsx("img",{src:"/images/start_img.gif",alt:""})}),s.jsxs("div",{className:"button__start",children:[s.jsx("button",{disabled:j,className:`button__grapstart ${j?"__disabled":""}`,onClick:()=>z(),children:"Start"}),s.jsx(S,{to:"/order",className:"butoon__order remove__lg",children:"Orders"})]}),s.jsx("div",{className:"terms__",children:s.jsx("span",{children:s.jsx(S,{to:"/tc",className:"remove__lg",children:"terms & conditions"})})}),s.jsxs("div",{className:"film__score",children:[s.jsxs("div",{className:"film__sc",children:[s.jsxs("div",{className:"grap__page",children:[" ","$",l==null?void 0:l.balance.toFixed(2)]}),s.jsxs("div",{className:"grap__",children:[l==null?void 0:l.tasksDone,"/",(f=o==null?void 0:o.vip)==null?void 0:f.dailyorder]})]}),s.jsxs("div",{className:"film__cadre",children:[s.jsxs("div",{className:"cadre__filma",children:[s.jsx("span",{className:"av__balance",children:"Today's earnings: "}),s.jsxs("label",{htmlFor:"",className:"balance__film",children:["$",d==null?void 0:d.toFixed(3)]})]}),s.jsxs("div",{className:"cadre__filma",children:[s.jsx("span",{className:"av__balance",children:"Account Balance : "}),s.jsxs("label",{htmlFor:"",className:"balance__film",children:["$",l==null?void 0:l.balance.toFixed(2)]})]}),s.jsxs("div",{className:"cadre__filma",children:[s.jsx("span",{className:"av__balance",children:"Freeze Balance : "}),s.jsxs("label",{htmlFor:"",className:"balance__film",children:["$",(v=l==null?void 0:l.freezeblance)==null?void 0:v.toFixed(2)]})]})]})]}),p&&s.jsx(J,{}),!p&&I&&a&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"film__modal",children:[s.jsx("div",{className:"film__modal__close",onClick:()=>B(),children:s.jsx("i",{className:"fa fa-close",style:{color:"white",fontSize:35}})}),s.jsxs("div",{className:"film__details",children:[s.jsxs("div",{className:"submit__information",children:[s.jsx("span",{className:"submit__information__title",children:"Submit Information"}),(a==null?void 0:a.photo)&&((b=a==null?void 0:a.photo[0])==null?void 0:b.downloadUrl)&&s.jsx("img",{src:(F=a==null?void 0:a.photo[0])==null?void 0:F.downloadUrl,alt:"",style:{width:"120px"}}),s.jsx("h3",{className:"grap__titleh3",children:a==null?void 0:a.title})]}),s.jsxs("div",{className:"creation__time",children:[s.jsx("span",{className:"title__creation",children:"Creation time:"}),s.jsx("label",{htmlFor:"",className:"date__creation",children:R.current()})]}),s.jsxs("div",{className:"order__number",children:[s.jsxs("div",{children:[s.jsx("span",{className:"tile",children:"Order Number:"}),s.jsx("span",{children:g})]}),s.jsxs("div",{children:[s.jsx("span",{className:"tile",children:"Order amount:"}),s.jsxs("span",{children:["$",a==null?void 0:a.amount]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"tile",children:"Income"}),s.jsxs("span",{children:["$",O(a==null?void 0:a.amount,a==null?void 0:a.commission)]})]})]}),s.jsxs("div",{className:"rating__box",children:[s.jsxs("div",{className:"buyer__rating",children:["Buyer Ratings (",x,"/5)"]}),s.jsxs("div",{children:[" ",s.jsx(K,{onClick:A,size:20})]})]}),s.jsx("div",{className:"rating__submit",onClick:()=>T(),children:"Submit"})]})]})})]})]})};export{ls as default};
